<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>VibeNet ‚Äî PM Shri KBJ Govt</title>
<script async src="https://www.googletagmanager.com/gtag/js?id=YOUR_GA_TRACKING_ID"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'YOUR_GA_TRACKING_ID');
</script>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
  import { getDatabase, ref, push, onValue, update } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-database.js";
  import { getAuth, signOut } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY_HERE", 
    authDomain: "the-vibenet.firebaseapp.com",
    projectId: "the-vibenet",
    storageBucket: "the-vibenet.firebasestorage.app",
    messagingSenderId: "750456552470",
    appId: "1:750456552470:web:87d410021cda7ef10a0937"
  };

  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app);
  const auth = getAuth(app);

  const postsRef = ref(database, 'posts');

  window.makePost = function() {
    const text = document.getElementById('composer').value.trim();
    
    if (text) {
      const postData = {
        user: document.getElementById('headerUser').textContent,
        caption: text,
        imageUrl: null, 
        timestamp: new Date().toISOString(),
        likes: 0
      };
      
      push(postsRef, postData);
      document.getElementById('composer').value = '';
    }
  };

  window.makeImagePost = function() {
    const text = document.getElementById('imageComposer').value.trim();
    const imageUrl = document.getElementById('imageUrlInput').value.trim();
    
    if (text || imageUrl) {
      const postData = {
        user: document.getElementById('headerUser').textContent,
        caption: text,
        imageUrl: imageUrl, 
        timestamp: new Date().toISOString(),
        likes: 0
      };
      
      push(postsRef, postData);
      document.getElementById('imageComposer').value = '';
      document.getElementById('imageUrlInput').value = '';
      closeUrlPopup();
    }
  };

  window.renderPosts = function() {
    onValue(postsRef, (snapshot) => {
      const posts = [];
      const postsData = snapshot.val();
      if (postsData) {
        for (let id in postsData) {
          posts.unshift({ id, ...postsData[id] });
        }
      }
      
      feed.innerHTML = '';
      if(posts.length === 0){
        feed.innerHTML = `<div style="text-align:center;color:var(--muted);font-style:italic;padding:20px;">No posts yet. Make a new one!</div>`;
      } else {
        posts.forEach((p) => {
          const el = document.createElement('div'); el.className='post';
          el.innerHTML = `
            <div class="post-header">
              <div class="avatar">${(p.user || '').replace(/[^A-Z]/gi,'').slice(0,2).toUpperCase()}</div>
              <div style="flex:1">
                <div style="font-weight:800">${p.user}</div>
                <div style="font-size:13px;color:var(--muted)">PM Shri KBJ Govt</div>
              </div>
            </div>
            ${p.imageUrl ? `<div class="post-body"><img src="${p.imageUrl}" alt="post image" onerror="this.onerror=null;this.src='https://via.placeholder.com/600x400.png?text=Image+not+found';"></div>` : ''}
            <div class="post-footer">
              <div>
                <div style="font-weight:700">${p.caption}</div>
                <div style="font-size:13px;color:var(--muted)">${new Date(p.timestamp).toLocaleDateString()}</div>
              </div>
              <div style="text-align:right">
                <div class="likes-count" id="likes-${p.id}">${p.likes.toLocaleString()}</div>
                <button class="like-btn" onclick="toggleLike('${p.id}')" id="likebtn-${p.id}">ü§ç Like</button>
              </div>
            </div>
          `;
          feed.appendChild(el);
        });
      }
    });
  };

  window.toggleLike = function(postId) {
    const postRef = ref(database, 'posts/' + postId);
    onValue(postRef, (snapshot) => {
        const currentLikes = snapshot.val().likes || 0;
        const btn = document.getElementById('likebtn-'+postId);
        let newLikes;
        if(btn.classList.contains('liked')){
            newLikes = Math.max(0, currentLikes - 1);
            btn.classList.remove('liked');
            btn.textContent = 'ü§ç Like';
        } else {
            newLikes = currentLikes + 1;
            btn.classList.add('liked');
            btn.textContent = '‚ù§Ô∏è Liked';
        }
        update(postRef, { likes: newLikes });
    }, { onlyOnce: true });
  };

  window.openUrlPopup = function() {
    document.getElementById('urlModalBg').style.display = 'flex';
  };

  window.closeUrlPopup = function() {
    document.getElementById('urlModalBg').style.display = 'none';
  };

  window.doLogout = function() {
      signOut(auth).then(() => {
          localStorage.removeItem('currentUser');
          window.location.href = "index.html";
      }).catch((error) => {
          console.error("Logout failed:", error);
      });
  };

  function initPage() {
      const username = localStorage.getItem('currentUser');
      if (!username) {
          window.location.href = "index.html";
          return;
      }
      document.getElementById('headerUser').textContent = username;
      document.getElementById('profileName').textContent = username;
      renderPosts();
  }
  
  window.addEventListener('load', initPage);

</script>

<style>
  :root{
    --red:#c7121a;
    --white:#ffffff;
    --bg:#fff6f6;
    --muted:#666;
    --card-shadow: 0 8px 30px rgba(0,0,0,0.08);
    --radius:12px;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial;background:var(--bg);color:#111}
  .site-header{background:var(--red);color:var(--white);padding:12px 18px;display:flex;align-items:center;justify-content:space-between;gap:12px;position:sticky;top:0;z-index:40}
  .brand{display:flex;align-items:center;gap:12px}
  .brand .logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,#fff2f2,rgba(255,255,255,0.06));display:flex;align-items:center;justify-content:center;font-weight:800;color:var(--red);font-size:18px}
  .site-title{font-weight:800;font-size:18px}
  .header-right{display:flex;gap:10px;align-items:center}
  .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.12);color:#fff;padding:8px 10px;border-radius:10px;cursor:pointer}
  .btn-white{background:#fff;color:var(--red);padding:8px 12px;border-radius:10px;border:0;cursor:pointer}
  .wrap{max-width:1100px;margin:20px auto;padding:0 16px;display:grid;grid-template-columns:320px 1fr;gap:18px}
  @media(max-width:920px){.wrap{grid-template-columns:1fr;padding:12px}}
  .panel{background:var(--white);border-radius:var(--radius);padding:16px;box-shadow:var(--card-shadow)}
  .login-title{font-size:20px;font-weight:800;color:var(--red);margin:0 0 6px 0}
  .muted{color:var(--muted);font-size:13px;margin-bottom:10px}
  .form-row{display:flex;flex-direction:column;gap:8px;margin-bottom:10px}
  input[type="text"], input[type="password"]{padding:10px 12px;border-radius:10px;border:1px solid #eee;font-size:15px}
  .signin{background:var(--red);color:white;border:0;padding:10px;border-radius:10px;font-weight:700;cursor:pointer;width:100%}
  .signin:active{transform:translateY(1px)}
  .inline-error{display:none;color:#b71c1c;font-size:14px;margin-top:6px;display:flex;gap:8px;align-items:center}
  .accounts {margin-top:12px}
  .accounts h4{margin:8px 0 10px 0;font-size:15px}
  .acct-item{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;background:#fff;border:1px solid #fbebeb;margin-bottom:8px}
  .copy-btn{background:var(--red);color:#fff;border:0;padding:6px 8px;border-radius:8px;cursor:pointer;font-size:13px}
  .top-actions{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:12px}
  .school-card{display:flex;justify-content:space-between;align-items:center;padding:12px;border-radius:10px;background:linear-gradient(180deg,#fff,#fff);border:1px solid rgba(199,18,26,0.08);box-shadow:var(--card-shadow);cursor:pointer}
  .school-name{font-weight:800;color:var(--red)}
  .composer{background:var(--white);padding:12px;border-radius:12px;box-shadow:var(--card-shadow);margin-bottom:14px}
  .composer input{width:100%;padding:10px;border-radius:10px;border:1px solid #f0e0e0;margin-bottom:10px;}
  .composer .post-btns{display:flex;gap:10px;align-items:center}
  .composer .post-btns .signin{flex:1;width:auto;margin:0}
  .composer .post-btns .btn-add-img{background:var(--red);color:#fff;border:0;padding:10px 12px;border-radius:10px;font-weight:700;cursor:pointer;width:auto}
  .feed{display:flex;flex-direction:column;gap:14px}
  .post{background:var(--white);border-radius:12px;box-shadow:var(--card-shadow);overflow:hidden}
  .post-header{display:flex;align-items:center;gap:10px;padding:12px}
  .avatar{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--red),#ff6b6b);display:flex;align-items:center;justify-content:center;color:white;font-weight:800}
  .post-body img{width:100%;display:block;height:auto}
  .post-footer{padding:12px;display:flex;justify-content:space-between;align-items:center;gap:12px}
  .like-btn{background:transparent;border:0;color:var(--red);font-weight:700;cursor:pointer}
  .likes-count{font-weight:700;color:var(--red)}
  .modal-bg{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:none;align-items:center;justify-content:center;padding:18px;z-index:80}
  .modal{width:100%;max-width:760px;background:var(--white);border-radius:12px;padding:18px;box-shadow:var(--card-shadow)}
  .tabs{display:flex;gap:8px;margin-bottom:12px}
  .tab{padding:8px 12px;border-radius:10px;border:1px solid #eee;cursor:pointer}
  .tab.active{background:var(--red);color:#fff;border-color:var(--red)}
  .users-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:8px;}
  .user-chip{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border-radius:8px;border:1px solid #f0e0e0;gap:8px}
  .user-chip a{color:var(--red);text-decoration:none;font-weight:700;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1}
  .copy-sm{background:var(--red);color:#fff;border:0;padding:6px 8px;border-radius:8px;cursor:pointer;font-size:13px;flex-shrink:0;}
  @media(max-width:920px){
    .wrap{grid-template-columns:1fr}
    .users-grid{grid-template-columns:repeat(auto-fill,minmax(140px,1fr))}
  }
</style>
</head>
<body>

<div class="wrap" id="main-content">
  <div class="panel" id="leftPanel">
    <div id="profileCard" style="margin-top:14px;background:linear-gradient(90deg,#fff,#fff);padding:12px;border-radius:10px">
      <div style="display:flex;align-items:center;gap:10px">
        <div style="width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--red),#ff6b6b);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800">VN</div>
        <div>
          <div id="profileName" style="font-weight:800">You</div>
          <div style="color:var(--muted);font-size:13px" id="profileSchool">PM Shri KBJ Govt</div>
        </div>
      </div>
    </div>
  </div>

  <div class="panel" id="rightPanel">
    <div class="site-header" id="siteHeader">
      <div class="brand"><div class="logo">VN</div><div class="site-title">Welcome to VibeNet</div></div>
      <div class="header-right">
        <div id="headerUser" style="background:rgba(255,255,255,0.06);padding:8px 10px;border-radius:10px;color:#fff;font-weight:700">‚Äî</div>
        <button class="btn-white" onclick="doLogout()">Logout</button>
      </div>
    </div>

    <div style="padding:18px">
      <div class="school-card" onclick="openModal()">
        <div>
          <div style="font-size:13px;color:var(--muted)">School</div>
          <div class="school-name" id="schoolName">PM Shri KBJ Govt</div>
        </div>
        <div style="font-weight:700;color:var(--red)">View Students</div>
      </div>

      <div class="composer">
        <input id="composer" placeholder="What's on your mind?" />
        <div class="post-btns">
            <button class="btn-add-img" onclick="openUrlPopup()">Add Photo</button>
            <button class="signin" onclick="makePost()">Post Text</button>
        </div>
      </div>

      <div class="feed" id="feed">
      </div>
    </div>
  </div>
</div>

<div class="modal-bg" id="modalBg">
  <div class="modal" role="dialog" aria-modal="true">
    <div style="display:flex;align-items:center;justify-content:space-between;gap:12px">
      <div style="font-weight:800" id="modalTitle">PM Shri KBJ Govt ‚Äî Students</div>
      <div><button class="copy-sm" onclick="closeModal()">Close</button></div>
    </div>

    <div class="tabs" style="margin-top:12px">
      <div class="tab active" id="tab9" onclick="selectTab(9)">Class 9</div>
      <div class="tab" id="tab10" onclick="selectTab(10)">Class 10</div>
    </div>

    <div id="usersArea">
      </div>

    <div style="margin-top:12px;color:var(--muted);font-size:13px">Click <strong>Copy</strong> to copy username to clipboard.</div>
  </div>
</div>

<div class="modal-bg" id="urlModalBg">
  <div class="modal" role="dialog" aria-modal="true">
    <div style="display:flex;align-items:center;justify-content:space-between;gap:12px">
      <div style="font-weight:800">Post a Photo</div>
      <div><button class="copy-sm" onclick="closeUrlPopup()">Cancel</button></div>
    </div>
    <div style="margin-top:12px;color:var(--muted);font-size:13px">
      First, upload your photo to a website like <a href="https://imgur.com" target="_blank" style="text-decoration: underline; color: inherit;">Imgur</a> or <a href="https://postimages.org" target="_blank" style="text-decoration: underline; color: inherit;">Postimages</a>. Then, copy the **direct image link** and paste it below.
    </div>
    <input id="imageUrlInput" placeholder="Paste image URL here" style="width:100%;padding:10px;border-radius:10px;border:1px solid #f0e0e0;margin-top:12px" />
    <input id="imageComposer" placeholder="Add a caption..." style="width:100%;padding:10px;border-radius:10px;border:1px solid #f0e0e0;margin-top:12px" />
    <button style="margin-top:10px" class="signin" onclick="makeImagePost()">Post Photo</button>
  </div>
</div>

<script>
/* ========== Config (edit these) ========== */
const SCHOOL_NAME = "PM Shri KBJ Govt";

const CLASS9 = [
  "gond_chua__143","miss_gond_nani143","toxic_queen_official","ishuuuuu__78","miss_hituu00",
  "miss_baby_doll1432","@kbj_s9_7","@kbj_s9_8","@kbj_s9_9","@kbj_s9_10",
  "@kbj_s9_11","@kbj_s9_12","@kbj_s9_13","@kbj_s9_14","@kbj_s9_15"
];
const CLASS10 = [
  "Bauri_man","Pagal---pagali---love","parabhatioram143","miss._gond._queen","sapnasuhana00",
  "prachitanaik145","pagili_nani_1432","@kbj_s10_8","@kbj_s10_9","@kbj_s10_10",
  "@kbj_s10_11","@kbj_s10_12","@kbj_s10_13","@kbj_s10_14","@kbj_s10_15"
];

const POSTS = [
  {user:"@principal_kbj", caption:"Annual day celebration ‚Äî proud moment for our school.", img:"https://source.unsplash.com/featured/?school,assembly", likes:21000},
  {user:"@kbj_school", caption:"Our new science lab inauguration.", img:"https://source.unsplash.com/featured/?school,classroom", likes:2000},
  {user:"@sports_kbj", caption:"Inter-school football championship ‚Äî great team spirit!", img:"https://source.unsplash.com/featured/?students,football", likes:50},
  {user:"@arts_kbj", caption:"Art & culture exhibition highlights.", img:"https://source.unsplash.com/featured/?school,students", likes:320}
];

const headerUser = document.getElementById('headerUser');
const profileCard = document.getElementById('profileCard');
const profileName = document.getElementById('profileName');
const profileSchool = document.getElementById('profileSchool');
const feed = document.getElementById('feed');
const modalBg = document.getElementById('modalBg');
const usersArea = document.getElementById('usersArea');
const modalTitle = document.getElementById('modalTitle');
const schoolNameEl = document.getElementById('schoolName');

schoolNameEl.textContent = SCHOOL_NAME;
modalTitle.textContent = SCHOOL_NAME + " ‚Äî Students";
profileSchool.textContent = SCHOOL_NAME;

function copyText(text){
  navigator.clipboard.writeText(text).then(()=>showToast('Copied: ' + text), ()=>alert('Copy failed ‚Äî copy manually: '+text));
}

function openModal(){ modalBg.style.display='flex'; selectTab(9); }
function closeModal(){ modalBg.style.display='none'; }
function selectTab(n){
  document.getElementById('tab9').classList.toggle('active', n===9);
  document.getElementById('tab10').classList.toggle('active', n===10);
  const users = (n===9)? CLASS9 : CLASS10;
  renderUsers(users);
}
function renderUsers(list){
  usersArea.innerHTML='';
  const grid = document.createElement('div'); grid.className='users-grid';
  list.forEach(u=>{
    const chip = document.createElement('div'); chip.className='user-chip';
    const a = document.createElement('a'); a.href='https://instagram.com/'+u.replace(/^@/,''); a.target='_blank'; a.textContent = u;
    const cbtn = document.createElement('button'); cbtn.className='copy-sm'; cbtn.textContent='Copy';
    cbtn.addEventListener('click', ()=> copyText(u) );
    chip.appendChild(a); chip.appendChild(cbtn);
    grid.appendChild(chip);
  });
  usersArea.appendChild(grid);
}

const toast = document.createElement('div'); toast.style.position='fixed'; toast.style.left='50%'; toast.style.transform='translateX(-50%)'; toast.style.bottom='20px'; toast.style.padding='10px 14px'; toast.style.background='#111'; toast.style.color='#fff'; toast.style.borderRadius='8px'; toast.style.display='none'; toast.style.zIndex='99'; document.body.appendChild(toast);
function showToast(t){ toast.textContent=t; toast.style.display='block'; setTimeout(()=>toast.style.display='none',1400); }

document.getElementById('modalBg').addEventListener('click', function(e){ if(e.target===this) closeModal(); });
document.getElementById('urlModalBg').addEventListener('click', function(e){ if(e.target===this) closeUrlPopup(); });

</script>
</body>
</html>
